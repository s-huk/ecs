input {
        kafka {
                bootstrap_servers => "172.16.16.66:9093,172.16.16.74:9093,172.16.16.75:9093"
                topics => ["ops_filebeat"]
                group_id => "amda_filebeat"
		codec => "json"
                security_protocol => "SSL"
                ssl_keystore_location => "/etc/logstash/kafka_client.jks"
                ssl_keystore_password => "123456"
                ssl_truststore_location => "/etc/logstash/keystore.jks"
                ssl_truststore_password => "123456"
        }
}
output {
        if [fields][service_type] == "haproxy_access_log" {
                pipeline {
                        send_to => "haproxy_access_log"
                }
	} else if [fields][service_type] == "fail2ban" {
		pipeline {
                        send_to => drop
                }
	} else if [fields][service_type] == "nginx_access_log" {
		 pipeline {
                        send_to => drop
                }
	} else if ([fields][service_type] == "auth_log" or [app_name] == "system-auth") {
                 pipeline {
                        send_to => "auth_log"
                }
	} else if [app_name] == "http-download" {
		pipeline {
                        send_to => "http-download"
                }
	} else if [app_name] == "ftp-download" {
		pipeline {
                        send_to => "ftp-download"
                }
	} else {
		pipeline {
                        send_to => drop
                }
	}
}
