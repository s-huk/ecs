input {
        kafka {
                bootstrap_servers => "172.16.16.66:9093,172.16.16.74:9093,172.16.16.75:9093"
                topics => ["ops_syslog_paloalto"]
                group_id => "amda_filebeat"
		codec => "json"
                security_protocol => "SSL"
                ssl_keystore_location => "/etc/logstash/kafka_client.jks"
                ssl_keystore_password => "123456"
                ssl_truststore_location => "/etc/logstash/keystore.jks"
                ssl_truststore_password => "123456"
        }
}
output {
        if [fields][service_type] == "pa_traffic" {
                pipeline {
                        send_to => "pa_traffic-ecs"
                        #send_to => drop
                }
	} else if [fields][service_type] == "pa_threat" {
		pipeline {
		                send_to => "pa_threat-ecs"
                        #send_to => drop
                }
	} else {
		pipeline {
                        send_to => drop
                }
	}
}